<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="DiffFaceSketch: High-Fidelity Face Image Synthesis with Sketch-Guided Latent Diffusion Model">
  <meta name="keywords" content="SGLDM, LDM, DiffFaceSketch">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DiffFaceSketch: High-Fidelity Face Image Synthesis with Sketch-Guided Latent Diffusion Model</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.ico">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<!-- <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div>
    </div>

  </div>
</nav> -->


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">DiffFaceSketch: High-Fidelity Face Image Synthesis with Sketch-Guided Latent Diffusion Model</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <h2>Anonymous</h2>
              <!-- <a href="https://keunhong.com">Keunhong Park</a><sup>1</sup>,</span> -->
            <!-- <span class="author-block">
              <a href="https://utkarshsinha.com">Utkarsh Sinha</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://jonbarron.info">Jonathan T. Barron</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="http://sofienbouaziz.com">Sofien Bouaziz</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.danbgoldman.com">Dan B Goldman</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://homes.cs.washington.edu/~seitz/">Steven M. Seitz</a><sup>1,2</sup>,
            </span>
            <span class="author-block">
              <a href="http://www.ricardomartinbrualla.com">Ricardo Martin-Brualla</a><sup>2</sup>
            </span> -->
          </div>

          <!-- <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of Washington,</span>
            <span class="author-block"><sup>2</sup>Google Research</span>
          </div> -->

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2302.06908"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
            

              <!-- <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span> -->
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href="https://github.com/puckikk1202/difffacesketch2023"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Dataset (coming)</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/puckikk1202/difffacesketch2023"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (coming)</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a> --> 
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container">
  <!-- <div class="container is-max-desktop"> -->
    <div class="hero-body">
      <image id="teaser" src="./static/images/teaser_vf.png">
      </image>  
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">Sketch-Guided Lantent Diffusion Model</span> (SGLDM) synthesizes high-quality face images with high consistency of input sketches.
      </h2>
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    
    <!-- Abstract. -->
    <h2 class="title is-3" style="text-align: center;">Abstract</h2>
    <div class="columns is-centered has-text-centered">
      <!-- <div class="column is-four-fifths"> -->
        <!-- <h2 class="title is-3">Abstract</h2> -->
        <div class="content has-text-justified">
          <p>
            Synthesizing face images from monochrome sketches is one of the most fundamental tasks in the field of image-to-image translation. 
            However, it is still challenging to (1)~make models learn the high-dimensional face features such as geometry and color, and (2)~take into account the characteristics of input sketches. 
            Existing methods often use sketches as indirect inputs (or as auxiliary inputs) to guide the models, resulting in the loss of sketch features or the alteration of geometry information. 
            In this paper, we introduce a Sketch-Guided Latent Diffusion Model (SGLDM), a LDM-based network architect trained on the paired sketch-face dataset. We apply a Multi-Auto-Encoder (AE) to encode the different input sketches from different regions of a face from pixel space to a feature map in latent space, which enables us to reduce the dimension of the sketch input while preserving the geometry-related information of local face details. We build a sketch-face paired dataset based on the existing method that extracts the edge map from an image. We then introduce a Stochastic Region Abstraction (SRA), an approach to augment our dataset to improve the robustness of SGLDM to handle sketch input with arbitrary abstraction.
            The evaluation study shows that SGLDM can synthesize high-quality face images with different expressions, facial accessories, and hairstyles from various sketches with different abstraction levels.
          </p>

        </div>
      <!-- </div> -->
    </div>
    <!--/ Abstract. -->
    
  </div>
</section>

<section class="hero is-light is-small">
<!-- <section class="section"> -->
  <div class="hero-body">
    <div class="container">
        <div class="item item-steve">
          <img id="framework" src="./static/images/framework.PNG"> 
        </div>
        <div>
          <h2>
            The framework of SGLDM. In the sketch embedding stage (a), given a sketch input <i>S</i>, a pretrained sketch encoder &zeta; encodes <i>S</i> into a feature vector <i>S'</i>. The decoder &#952; then decoder <i>S'</i> into a feature map <i>S<sup>&tilde;</sup></i>. In the latent denoising stage (b), the random latent code <i>Z<sub>T</sub></i> is concatenated by the feature map <i>S<sup>&tilde;</sup></i> and denoised to &zeta; by a U-Net. Finally, the output latent code <i>Z<sub>0</sub></i> is decoded by a decoder <i>D</i> to the final output.  
          </h2>   
        </div>
    </div>
  </div>
</section>


<!-- <section class="hero is-light is-small"> -->
<section class="section">
  <div class="container">
    
    <div class="columns is-centered">

      <!-- Distribution Mapping -->
      <div class="column">
        <div class="content">
          <h2 class="title is-3">Distribution Mapping</h2>
          <br><br>
            The different feature distribution mapping between jointly trained conditional embedding (dashed line) and the separately trained conditional embedding (solid line), from the sketch (a) to the image (b) domain.
          </p>
          <image id="distribution" src="./static/images/distribution_v3.png">
          </image>  
        </div>
      </div>
      <!--/ Visual Effects. -->

      <!-- Stochastic Region Abstraction Data Augmentation -->
      <div class="column">
        <h2 class="title is-3">Stochastic Region Abstraction Data Augmentation</h2>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              The original image in Celeba-HQ and its extracted edge map (a), and the result of paired data after cleaning up the background (b). Sketch simplification results from 3 different resolutions faces (left-bottom). And the random seamed data samples (right-bottom).
            </p>
            <image id="distribution" src="./static/images/dataset.png">

            </image>
          </div>

        </div>
      </div>

    </div>
  
    <!--/ Stochastic Region Abstraction Data Augmentation -->

    <!-- Animation. -->
    <!-- <h2 class="title is-3">Result</h2> -->
    <div class="columns is-centered">

      <div class="column">
        <div class="content">
          <h2 class="title is-3">Sketch Abstraction Robustness</h2>
          <p>
            We compared the synthetic faces of the 2-Stage trained model and the jointly trained model.
          </p>
          <img id="distribution" src="./static/images/ablation_v3.png">  
        </div>
      </div>
    

      <!-- Stochastic Region Abstraction Data Augmentation -->
      <div class="column">
        <h2 class="title is-3">Editing Capability</h2>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              Examples of partial editing such as hairstyles, earings, and expressions.
            </p>
            <image id="distribution" src="./static/images/editing.png">
            </image>
          </div>

        </div>
      </div>

    </div>

  </div>
</section>

<section class="section">
  <div class="container">
    
    <!-- More Result -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Comparasion Study</h2>
        <p>
          We compared the synthetic faces of the proposed SGLDM with the state-of-the-art methods. From the results, we confirm that SGLDM can synthesizes noiseless faces maintaining maximum consistency with the input sketch, except for some facial details such as nasolabial folds.
        </p>
        <br>
        <div style="text-align: center;">
          <image src="./static/images/qualitative_v2.png"></image>
        </div>
      </div>
    </div>
    <!--/ More Result -->
    
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container">
    <h2 class="title">BibTeX</h2>
    <pre><code>
      @misc{https://doi.org/10.48550/arxiv.2302.06908,
            doi = {10.48550/ARXIV.2302.06908},
            url = {https://arxiv.org/abs/2302.06908},
            title = {DiffFaceSketch: High-Fidelity Face Image Synthesis with Sketch-Guided Latent Diffusion Model},
            year = {2023},
            }
    </code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <!-- <div class="content has-text-centered"> -->
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    <!-- </div> -->
    <!-- <div class="columns is-centered"> -->
      <!-- <div class="column is-8"> -->
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      <!-- </div> -->
    <!-- </div> -->
  </div>
</footer>

</body>
</html>
